"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1285],{1285:(V,g,s)=>{s.r(g),s.d(g,{MapViewPageModule:()=>L});var f=s(6814),v=s(95),c=s(3582),u=s(3044),m=s(5861),n=s(6689),w=s(3681);const M=["map"],y=[{path:"",component:(()=>{var i;class a{constructor(o,e){this.ngZone=o,this.roomsService=e,this.infoWindows=[],this.markers=[]}ionViewDidEnter(){this.showMap()}ngOnInit(){this.roomsService.getRooms().subscribe(o=>{this.markers=o,this.fetchCoordinatesAndShowOnMap()})}fetchCoordinatesAndShowOnMap(){var o=this;return(0,m.Z)(function*(){for(const e of o.markers)try{const t=yield o.getCoordinatesForLocation(e.location);t&&(e.latitude=t.lat,e.longitude=t.lng,console.log(e.latitude,e.longitude),o.addMarkerToMap(e))}catch(t){console.error("Error fetching coordinates for location",t)}})()}getCoordinatesForLocation(o){return(0,m.Z)(function*(){const e=`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(o)}&key=AIzaSyCIg58baI6932Ur5BAou6kk6ohg1uqSPtc`;try{const r=yield(yield fetch(e)).json();if(r.results.length>0)return r.results[0].geometry.location}catch(t){return console.error("Error fetching coordinates",t),null}})()}addMarkerToMap(o){let e=new google.maps.LatLng(o.latitude,o.longitude),t=new google.maps.Marker({position:e,title:o.location});t.setMap(this.map),this.addInfoWindowToMarker(t,o)}addInfoWindowToMarker(o,e){var t,r;const h=(null==e||null===(t=e.location)||void 0===t||null===(t=t.charAt(0))||void 0===t?void 0:t.toUpperCase())+(null==e||null===(r=e.location)||void 0===r?void 0:r.slice(1));let d=new google.maps.InfoWindow({content:`\n      <div id="content">\n        <h2 id="firstHeading" class="firstHeading">${h}</h2>\n        <img src="${e.frontImage}" width="100" height="100">\n        <p>Price: \u20b9${e.price}</p>\n        <p>Number of Rooms for Rent: ${e.numRoomsForRent}</p>\n        <p>Latitude: ${e.latitude}</p>\n        <p>Longitude: ${e.longitude}</p>\n        <ion-button id="navigate">Navigate</ion-button>\n      </div>\n    `});o.addListener("click",()=>{this.closeAllInfoWindows(),d.open(this.map,o),google.maps.event.addListenerOnce(d,"domready",()=>{var p;null===(p=document.getElementById("navigate"))||void 0===p||p.addEventListener("click",()=>{this.navigateToLocation(null==e?void 0:e.latitude,null==e?void 0:e.longitude)})})}),this.infoWindows.push(d)}navigateToLocation(o,e){var t;console.log(o,e);let r=new google.maps.LatLng(o,e);null!=this&&null!==(t=this.platform)&&void 0!==t&&t.is("cordova")?this.googleMaps.getPlugin().then(()=>{this.googleMaps.navigate({destination:r,start:"",transportMode:"driving",launchMode:"turn-by-turn"})}):window.open(`https://www.google.com/maps/dir/?api=1&destination=${o},${e}`,"_system")}closeAllInfoWindows(){for(let o of this.infoWindows)o.close()}showMap(){var o;const t={center:new google.maps.LatLng(19.0759837,72.8776559),zoom:5,disableDefaultUI:!0};this.map=new google.maps.Map(null===(o=this.mapRef)||void 0===o?void 0:o.nativeElement,t),this.addMarkerToMap(this.markers)}}return(i=a).\u0275fac=function(o){return new(o||i)(n.Y36(n.R0b),n.Y36(w.L))},i.\u0275cmp=n.Xpm({type:i,selectors:[["app-map-view"]],viewQuery:function(o,e){if(1&o&&n.Gf(M,5,n.SBq),2&o){let t;n.iGM(t=n.CRH())&&(e.mapRef=t.first)}},decls:7,vars:2,consts:[[3,"translucent"],[1,"ion-text-center"],[3,"fullscreen"],["id","map"],["map",""]],template:function(o,e){1&o&&(n.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title",1),n._uU(3,"Map view"),n.qZA()()(),n.TgZ(4,"ion-content",2),n._UZ(5,"div",3,4),n.qZA()),2&o&&(n.Q6J("translucent",!0),n.xp6(4),n.Q6J("fullscreen",!0))},dependencies:[c.W2,c.Gu,c.wd,c.sr],styles:["#map[_ngcontent-%COMP%]{height:100%}"]}),a})()}];let P=(()=>{var i;class a{}return(i=a).\u0275fac=function(o){return new(o||i)},i.\u0275mod=n.oAB({type:i}),i.\u0275inj=n.cJS({imports:[u.Bz.forChild(y),u.Bz]}),a})(),L=(()=>{var i;class a{}return(i=a).\u0275fac=function(o){return new(o||i)},i.\u0275mod=n.oAB({type:i}),i.\u0275inj=n.cJS({imports:[f.ez,v.u5,c.Pc,P]}),a})()}}]);